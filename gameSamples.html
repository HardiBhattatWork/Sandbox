<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Hardi Bhatt's Website | Code</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="css/style.css" rel="stylesheet" type="text/css" />
<link rel="stylesheet" type="text/css" href="css/coin-slider.css" />
<link rel="stylesheet" type="text/css" href="shadowbox/shadowbox.css">
<script type="text/javascript" src="js/cufon-yui.js"></script>
<script type="text/javascript" src="js/droid_sans_400-droid_sans_700.font.js"></script>
<script type="text/javascript" src="js/jquery-1.4.2.min.js"></script>
<script type="text/javascript" src="js/script.js"></script>
<script type="text/javascript" src="js/coin-slider.min.js"></script>
<script type="text/javascript" src="js/utils.js"></script>
<script type="text/javascript" src="js/shCore.js"></script>
<script type="text/javascript" src="js/shBrushCpp.js"></script>
<script type="text/javascript" src="js/shBrushCSharp.js"></script>
<script type="text/javascript" src="js/shBrushJava.js"></script>
<script type="text/javascript" src="shadowbox/shadowbox.js"></script>
<script type="text/javascript">
Shadowbox.init({
    handleOversize: "drag",
    modal: true
});

$(document).ready(function(){
	
	$(".toggle_container").hide();

	$("h4.trigger").toggle(function(){
		$(this).addClass("active"); 
		}, function () {
		$(this).removeClass("active");
	});
	
	$("h4.trigger").click(function(){
		$(this).next(".toggle_container").slideToggle("slow,");
	});

});

	SyntaxHighlighter.config.clipboardSwf = 'js/clipboard.swf';
	SyntaxHighlighter.all();
</script>
</head>
<body>
<div class="main">
  <div class="header">
    <div class="header_resize">
      <div class="menu_nav">
         <ul>
          <li><a href="index.html"><span>Home Page</span></a></li>
          <li class="active"><a href="myArchive.html"><span>My Work</span></a></li>
          <li><a href="myResume.html"><span>My Resume</span></a></li>
          <li><a href="aboutMe.html"><span>About Me</span></a></li>
          <li><a href="myContact.html"><span>Contact Me</span></a></li>
        </ul>
      </div>
      <div class="logo">
        <h1><a href="index.html"><span>Hardi Bhatt</span> <small>A Creative Programmer</small></a></h1>
      </div>
      <div class="clr"></div>
      <div class="slider">
         <div id="coin-slider"> <a href="#"><img src="images/slide1.jpg" width="1500" height="327" alt="" /> </a> <a href="#"><img src="images/slide2.jpg" width="1500" height="327" alt="" /> </a> <a href="#"><img src="images/slide3.jpg" width="1500" height="327" alt="" /> </a> <a href="#"><img src="images/slide4.jpg" width="1500" height="327" alt="" /> </a> </div>
        <div class="clr"></div>
      </div>
      <div class="clr"></div>
    </div>
  </div>
  <div class="content">
    <div class="content_resize">
      <div class="mainbar">
	  <div class="article">
          <h2><span>engineDIVINE</span></h2>
          <div class="clr"></div>
          <p>
			<div class="panelcollapsed">
			  <h3>engineDIVINE Boss AI Code</h3>
			  <div class="panelcontent">
				<pre class="brush: c++;" style="overflow: hidden;">
//----------------------------------------------------------------------------
//engine:DIVINE was a game prototype created at Drexel University during one 
//of the game development classes. engine:DIVINE is a fast-paced, epic 
//third-person shooter focusing on large-scale "boss" encounters, featuring 
//several phases and playstyles for each enemy the main character faces. 
//The initial proof of concept was created in a ten-week course with the Lead 
//Developer and four others creating a single level of the game. The subsequent 
//class had all new team members, thirteen in total, focusing on developing 
//another encounter for the prototype. This prototype was featured at 
//Eurographics '08 in Greece. My task in this game was as a Lead Programmer. 
//
//Boss AI: I built the AI framework for this game, which is featured in the 
//samples section.  
//
//Particle effect: Implemented all the partical effects for the game. The eye 
//beam target shooting for the "Owle Boss," moniter beam particles, mini flying 
//owl probes eyebeam particles, and gun shooting particles for the main character.
//
//Audio: Implemented all the audio in the game for the "Owle Boss" level
//
//Project Team: Alex Serret, Josh Sankey, Jordan Santell, James Borden, 
//Hardik Bhatt, Zachary Brooks, Brittany Tress, Scott Ackerman, Kevin Appel
//
//This function handles all the owl phases
//----------------------------------------------------------------------------
function owlAI_phases()
{
	c_setminmax( me ) ;
	owlBoss.shadow = on;
	ent_create("eye.mdl",owlBoss.x,attach);
	var laserBool = 0 ;
	var waitTime ;
	
	media_loop( "BossLoop.ogg", null, 50 );
	
	while(1)
	{	
		on_1 = p1;
		on_2 = phase2;
		on_3 = phase3;
		on_4 = phase4;
		on_5 = kill; //dead
		if (getBossHealth() >= 80 && getBossHealth() %3c= 100 && VULNERABLE == 0)
		{	
			PHASE = 1;	
			if( WALKING == 0 )
			{
				my.blendframe = walk;
				WALKING = 1;
			}
			handle_animation(.3);
			if( SHOTS_COUNTER %3c 2 ) //More than x number of shots means time for laser
			{
				laserBool = 1 ;	
				followDoc( 30, 1 );
				if( DOC_VISIBLE == 1 )
				{
					targetShootDoc();
				}
			}
			else
			{
				if( DOC_VISIBLE == 0 || laserBool == 0 )
				{
					followDoc( 30, 1 );
				}
				if( laserBool == 1 && DOC_VISIBLE == 1) //only want to enter this area once
				{
					shootLaser();
					laserBool = 0;
				}
			}
		}
		if( PHASE == 1 && VULNERABLE == 1)
		{
			if( my.blendframe != stand )
			{
				my.blendframe = stand;
			}
			waitTime = 0;
			while( waitTime %3c 300 && VULNERABLE == 1 )
			{
				if( waitTime % 5 == 0 )
				{
					handleEyeColors();
				}
				handle_animation(.4);
				waitTime += 1;
				wait(1);
			}
			WALKING = 0;
			ent_morphskin( owlBossEye, "black.tga");
			VULNERABLE = 0;
		}
		
		if (getBossHealth() >= 55 && getBossHealth() %3c= 79 && VULNERABLE == 0)
		{
			PHASE = 2;
			BEAMWIDTH = 8 ;
			zStrength = -75 ;
			width = 15;
			goToCenter();
			if( laserBool == 0 )
			{
				shootLaser();
				laserBool = 1;
			}
			if( SAT_ACTIVE == 0 )
			{
				spawnSatellites();
				SAT_ACTIVE = 1;
			}
			if(FLYING == 0)
			{
				ent_create("emitter.mdl", my.x, attachLWing );
				ent_create("emitter.mdl", my.x, attachRWing );
				my.blendframe = takeoff;
				FLYING = 1;
			}		
			handle_animation(.2);
		}
		
		if( (PHASE == 2 || PHASE == 3) & VULNERABLE == 1 )
		{
			waitTime = 0;
			while( waitTime %3c 500 && VULNERABLE == 1 )
			{
				if( waitTime % 5 == 0 )
				{
					handleEyeColors();
				}
				handle_animation(.4);
				waitTime += 1;
				wait(1);
			}
			ent_morphskin( owlBossEye, "black.tga");
			laserBool = 0;
			VULNERABLE = 0;
		}
		
		
		if (getBossHealth() >= 35 && getBossHealth() %3c= 54 && VULNERABLE == 0)
		{
			PHASE = 3;
			goToCenter();
			pSizeHandler();
			if( WALLGO == 1 )
			{
				WALLGO = 0 ;
				wallActivate();
			}
			handle_animation(.2);
		}
		
		if (getBossHealth() > 0 && getBossHealth() %3c= 34)
		{
			VULNERABLE = 1;
			PHASE = 4;
			owlBoss.passable = on;
			if( OPENC == 0 )
			{
				my.blendframe = open;
				OPENC = 1;
			}
			createCore();
			if( owlBossEye != null  )
			{
				ent_remove(owlBossEye);
			}
			targetShootDoc();
			shootVertical();
			handle_animation(.3);
		}
		
		if (getBossHealth() %3c= 0)
		{
			PHASE = 5;
			if( FLYING == 1 )
			{
				my.blendframe = death;
				FLYING = 0;
			}
			if(sat1 != null)
			{
				sat1.blendframe = death;
				wait(-1);
				ent_remove(sat1);
			}
			if(sat2 != null)
			{
				sat2.blendframe = death;
				wait(-1);
				ent_remove(sat2);
			}
			handle_animation(.2);
		}
		wait(1);
	}
}
                    </pre>
			  </div>
			</div>
			<h4>Output: <a rel="shadowbox;width=600;height=500" href="doc/content/Videos/engineDivine_trailer.flv" title="Random Search">See Video</a></h4>
			</p>
        </div>
		<div class="article">
          <h2><span>Maxwells Demon</span></h2>
          <div class="clr"></div>
          <p>
			<div class="panelcollapsed">
			  <h3>Maxwells Demon BCI Code</h3>
			  <div class="panelcontent">
				<pre class="brush: csharp;" style="overflow: hidden;">
//----------------------------------------------------------------------------
//A 3D puzzle based game which utilizes NeuroSky BCI technology to allow users 
//to actually move objects within the game with their minds. This game is still 
//in BETA due to Blade 3D being a brand new engine and the fact that BCI 
//interface with gaming is something that has never been attempted thus far. 
//I was the lone programmer in this project.
//
//Neurosky Integration: Integrating the NeuroSky device with the Blade3D Game 
//Engine, the coding was mostly done in C# and integration with the Blade 3D 
//game engine required Blade 3D specific syntax. 
//
//Random Distraction: A random distraction generator with would cycle through 
//1 random distraction out of 5 per level and trigger when the attention level 
//of the player was raised to a certain point.
//
//XML File Generator: For research purposes I was also give the task of 
//programmatically generating an XML file which would hold specific player 
//data during a specific time in order to document when a player was, what is 
//attention level was, and which distract had occurred to trigger a distortion 
//in the players Attention. This was done so that it could be charted in flash 
//for ease of use.
//
//Project Team: Craig Stevenson, Arjun Gupta, Peter Stratton, Phil Lyon, 
//Hardik Bhatt, Jeff Lorenz
//----------------------------------------------------------------------------
using System;
using System.Diagnostics;
using System.IO;
using System.Runtime.InteropServices;
using System.Threading;
using Blade3D.Runtime;


namespace NeuroSkyFinal
{
	public interface INeuroSkyFinal
	{
		[DefineProp(Description = "The Attention meter of the NeuroSky", DefaultValue = "0.0", IsPersistent = true, IsReadOnly = true, DisplayName = "AttentionMeter", StepValue = "1.0")]
		float AttentionMeter { get; set; }

		[DefineProp(Description = "The Meditation meter of the NeuroSky", DefaultValue = "0.0", IsPersistent = true, IsReadOnly = true, DisplayName = "MeditationMeter", StepValue = "1.0")]
		float MeditationMeter { get; set; }

		[DefineProp(Description = "Indicates if the NeuroSky is on or off")]
		bool NeuroSkyConnection { get; set; }

	}
	[
		Blade3DComponent("NeuroSkyComponent", typeof(INeuroSkyFinal))
	]
	public class NSkyFinalClass: ComponentBase, INeuroSkyFinal
	{
		//-------------------------------------------------------------------------------------
		public const int STREAM_PACKETS = 2;
		public const int THINKGEAR_LOG_ESENSE_ATTENTION = 1;
		public const int THINKGEAR_LOG_ESENSE_MEDITATION = 2;

		int NSKY; 
		bool hasBeenOpened = false;
		

		[DllImport("thinkgear.dll")]
		public static extern int GetThinkGearESenseValue(int id, int eSenseType);

		[DllImport("thinkgear.dll")]
		public static extern int StartThinkGearStream(int id, int streamType, string streamName);

		[DllImport("thinkgear.dll")]
		public static extern int NewThinkGearInstance();
		//-------------------------------------------------------------------------------------
		
		public Property<float> AttentionMeter;             //get the result of the attention read in by NeuroSky
		public Property<float> MeditationMeter;            //get the result of the Meditation read in by NeuroSky
		public Property<bool> NeuroSkyConnection;           //checks to see if the neurosky is connecter

		public NSkyFinalClass()
		{
			this.AttentionMeter = new Property<float>(this);
			this.MeditationMeter = new Property<float>(this);
			this.NeuroSkyConnection = new Property<bool>(this);
		}

		#region Interface Methods
		float INeuroSkyFinal.AttentionMeter
		{
			get
			{
				return this.AttentionMeter.Value;
			}
			set
			{
				this.AttentionMeter.Value = value;
			}
		}
		float INeuroSkyFinal.MeditationMeter
		{
			get
			{
				return this.MeditationMeter.Value;
			}
			set
			{
				this.MeditationMeter.Value = value;
			}
		}
		bool INeuroSkyFinal.NeuroSkyConnection
		{
			get
			{
				return this.NeuroSkyConnection.Value;
			}
			set
			{
				XConsole.WriteLine("The Set NeuroSkyConnection is " + this.NeuroSkyConnection.Value);
				this.NeuroSkyConnection.Value = value;
			}
		}
		#endregion

		protected override void Attach()
		{
			//Subscribe to the frames first unpdate
			//for the scene item
			this.SceneItem.PreUpdate += pleaseWork;
			base.Attach();
		}

		protected override void Detach()
		{
			this.SceneItem.PreUpdate -= pleaseWork;
			base.Detach();
		}

		public void pleaseWork(ISceneItem sceneItem)
		{
			if (ObjectStore.ExecutionMode != ExecutionMode.PlayMode)
				return;
			if (this.NeuroSkyConnection.Value == true && hasBeenOpened == false)
			{
				//Initiate NeuroSky technology. 
				//In this sample tutorial, the COM port has been hard coded to COM5. Change as appropriate. 
				NSKY = NewThinkGearInstance();
				StartThinkGearStream(NSKY, STREAM_PACKETS, "COM5");
				hasBeenOpened = true;
			}
			else if(this.NeuroSkyConnection.Value == true && hasBeenOpened == true)
			{
				//--------------------------------------------------------------------------------------------
				this.AttentionMeter.Value = GetThinkGearESenseValue(NSKY, THINKGEAR_LOG_ESENSE_ATTENTION);
				//XConsole.Write(this.AttentionMeter.Value.ToString());
				this.MeditationMeter.Value = GetThinkGearESenseValue(NSKY, THINKGEAR_LOG_ESENSE_MEDITATION);
				//XConsole.WriteLine("  " + this.MeditationMeter.Value.ToString());
				
			}
			else
			{
				XConsole.WriteLine("You have not started the BCI");
			}
		}
	}
}
                    </pre>
			  </div>
			</div>
			<h4>Output: <a rel="shadowbox;width=600;height=500" href="doc/content/Videos/Maxwells_Demon_Trailer_hi.flv" title="Random Search">See Video</a></h4>
			<h4>Game Design Document:<a rel="shadowbox;width=800;height=600" href="doc/content/DesignDocV4.pdf">(20.1mb/PDF)</a></h4>
			<h4>ACM Siggraph Research Document:<a rel="shadowbox;width=800;height=600" href="doc/content/MD_ACMSubmission.pdf">(214kb/PDF)</a></h4>
			</p>
        </div>
        <div class="article">
          <h2><span>Torque 3D</span><a href="doc\content\GameExe_Torque.rar" title="Torque Game">-> Click to Download Game</a></h2>		  
          <div class="clr"></div>
          <p>
			<div class="panelcollapsed">
			  <h3>Torque Earthquake</h3>
			  <div class="panelcontent">
				<pre class="brush: cpp;" style="overflow: hidden;">
//===========================================================================
//
//! \file   Quake
//! \brief  This program simulates an Earthquake by randomly changing the x 
//          and the y coordinates. 
//
//===========================================================================
function Quake(%shape, %duration) 
{
	%lx = getword(%shape.getTransform(), 0); //get the current transform values
	%ly = getword(%shape.getTransform(), 1);
	%lz = getword(%shape.getTransform(), 2);
	%rx = getword(%shape.getTransform(), 3);
	%ry = getword(%shape.getTransform(), 4);
	%rz = getword(%shape.getTransform(), 5);
	%rd = getword(%shape.getTransform(), 6);
	//loop through the earthquake for %duration (cycles)
	if(%duration > 0)
	{			
		%shape.setTransform(%lx SPC %ly SPC %lz SPC %rx SPC %ry SPC %rz SPC %rd );
		%MINMAX = 1; //used to generate numbers
		%Num = GetRandom(-%MINMAX,%MINMAX); //generating random nuber
		%lx += %Num;//setting the result
		%ly += %Num;
				//moving the building
		%shape.setTransform(%lx SPC %ly SPC %lz SPC %rx SPC %ry SPC %rz SPC %rd );
		schedule(70, 0, Quake, %shape, (%duration-1));
	}//end if  
	else 
	{
		%shape.setTransform($lxConst SPC $lyConst SPC $lzConst SPC $rxConst SPC $ryConst SPC $rzConst SPC $rdConst );
		echo ("Quake: done.");
	}  	
}
                    </pre>
			  </div>
			</div>
			<h4>Output: <a rel="shadowbox;width=600;height=500" href="doc/content/Videos/Torque_Earthquake.flv" title="Random Search">See Video</a></h4>
			</p>
			<p>
			<div class="panelcollapsed">
			  <h3>Torque Sink</h3>
			  <div class="panelcontent">
				<pre class="brush: cpp;" style="overflow: hidden;">
//===========================================================================
//
//! \file   Sink
//! \brief  This program simulates a QuickSand by changing the z coordinate
//          given by user
//
//===========================================================================
function Sink (%shape, %dist)
{
	%lx = getword(%shape.getTransform(), 0); //get the current transform values
	%ly = getword(%shape.getTransform(), 1);
	%lz = getword(%shape.getTransform(), 2);
	%rx = getword(%shape.getTransform(), 3);
	%ry = getword(%shape.getTransform(), 4);
	%rz = getword(%shape.getTransform(), 5);
	%rd = getword(%shape.getTransform(), 6);
	
	//loop through the sink for %dist (cycles)
	if (%dist > 0)
	{
		%lz -= 0.02;//setting the result
		echo ("the z ", %lz );	
		//moving the building
		%shape.setTransform(%lx SPC %ly SPC %lz SPC %rx SPC %ry SPC %rz SPC %rd );
		schedule(70, 0, QuickSand, %shape, (%dist-1));
	}//end if
	else 
	{
		echo ("Sink: done.");v
	}    
}
                    </pre>
			  </div>
			</div>
			<h4>Output: <a rel="shadowbox;width=600;height=500" href="doc/content/Videos/Torque_Sink.flv" title="Random Search">See Video</a></h4>
			</p>
			<p>
			<div class="panelcollapsed">
			  <h3>Torque Rotate</h3>
			  <div class="panelcontent">
				<pre class="brush: cpp;" style="overflow: hidden;">
//===========================================================================
//
//! \file   Rotate
//! \brief  This program simulates an Rotation by randomly changing the
//          last rd coordinate or angle
//
//===========================================================================
function Rotate(%shape, %amount)
{
	%xfrm = %shape.getTransform();
	%lx = getword(%xfrm, 0); //get the current transform values
	%ly = getword(%xfrm, 1);
	%lz = getword(%xfrm, 2);
	%rx = getword(%xfrm, 3);
	%ry = getword(%xfrm, 4);
	%rz = getword(%xfrm, 5);
	%rd = getword(%xfrm, 6);

	%rd += 0.01;   //adjust the rd angle
	//loop through the sink for %dist (cycles)
	if (%amount > 0)
	{
		%rd += 0.01;   //adjust the rd angle
		//moving the building
		%shape.setTransform(%lx SPC %ly SPC %lz SPC %rx SPC %ry SPC %rz SPC %rd );
		//loop through the earthquake for %amount
		schedule(70, 0, Rotate, %shape, (%amount-1));
	}//end if    
	else 
	{
		%shape.setTransform($lxConst SPC $lyConst SPC $lzConst SPC $rxConst SPC $ryConst SPC $rzConst SPC $rdConst );
		echo ("Rotate: done.");
	}  	
}

                    </pre>
			  </div>
			</div>
			<h4>Output: <a rel="shadowbox;width=600;height=500" href="doc/content/Videos/Torque_Rotate.flv" title="Random Search">See Video</a></h4>
			</p>
			<p>
			<div class="panelcollapsed">
			  <h3>Torque Clones</h3>
			  <div class="panelcontent">
				<pre class="brush: cpp;" style="overflow: hidden;">
//======================================================================
// control/client.cs
//
// This module contains client specific code for handling
// the setup and operation of the player's in-game interface.
//
// 3D2E emaga4 tutorial game
//
//  Copyright (c) 2003, 2006 by Kenneth C. Finney.
//======================================================================

if ( IsObject( playerKeymap ) )  // If we already have a player key map,
   playerKeymap.delete();        // delete it so that we can make a new one
new ActionMap(playerKeymap);

if ( IsObject( cloneKeymap ) )  // If we already have a clone key map,
   cloneKeymap.delete();        // delete it so that we can make a new one
new ActionMap(cloneKeymap);

$movementSpeed = 1;             // m/s   for use by movement functions

//-----------------------------------------------------------------
// The player sees the game via this control
//-----------------------------------------------------------------
new GameTSCtrl(PlayerInterface) {
   profile = "GuiContentProfile";
   noCursor = "1";
};
//=====================New Code NOW=================================


//======================End New Code NOW============================
function PlayerInterface::onWake(%this)
//------------------------------------------------------------------
// When PlayerInterface is activated, this function is called.
//------------------------------------------------------------------
{
   $enableDirectInput = "1";
   activateDirectInput();

   // restore the player's key mappings
   playerKeymap.push();
}

//----------------------------------------------------------------------------
// The clone sees the game via this control
//----------------------------------------------------------------------------

new GameTSCtrl(CloneInterface) {
   profile = "GuiContentProfile";
   noCursor = "1";
};

function CloneInterface::onWake(%this)
//----------------------------------------------------------------------------
// When CloneInterface is activated, this function is called.
//----------------------------------------------------------------------------
{
   $enableDirectInput = "1";
   activateDirectInput();

   // restore the player's key mappings
   cloneKeymap.push();
}

function GameConnection::InitialControlSet(%this)
//----------------------------------------------------------------------------
// This callback is called directly from inside the Torque Engine
// during server initialization.
//----------------------------------------------------------------------------
{
   Echo ("Setting Initial Control Object");

   // The first control object has been set by the server
   // and we are now ready to go.

   Canvas.SetContent(PlayerInterface);
}

//============================================================================
// Motion Functions
//============================================================================

function GoLeft(%val)
//----------------------------------------------------------------------------
// "strafing"
//----------------------------------------------------------------------------
{
   $mvLeftAction = %val;
}

function GoRight(%val)
//----------------------------------------------------------------------------
// "strafing"
//----------------------------------------------------------------------------
{
   $mvRightAction = %val;
}

function GoAhead(%val)
//----------------------------------------------------------------------------
// running forward
//----------------------------------------------------------------------------
{
   $mvForwardAction = %val;
}

function BackUp(%val)
//----------------------------------------------------------------------------
// running backwards
//----------------------------------------------------------------------------
{
   $mvBackwardAction = %val;
}

function DoYaw(%val)
//----------------------------------------------------------------------------
// looking, spinning or aiming horizontally by mouse or joystick control
//----------------------------------------------------------------------------
{
   $mvYaw += %val * ($cameraFov / 90) * 0.02;
}

function DoPitch(%val)
//----------------------------------------------------------------------------
// looking vertically by mouse or joystick control
//----------------------------------------------------------------------------
{
   $mvPitch += %val * ($cameraFov / 90) * 0.02;
}

function DoJump(%val)
//----------------------------------------------------------------------------
// momentary upward movement, with character animation
//----------------------------------------------------------------------------
{
   $mvTriggerCount2++;
}

//============================================================================
// View Functions
//============================================================================

function Toggle3rdPPOVLook( %val )
//----------------------------------------------------------------------------
// Enable the "free look" feature. As long as the mapped key is pressed,
// the player can view his avatar by moving the mouse around.
//----------------------------------------------------------------------------
{
   if ( %val )
	  $mvFreeLook = true;
   else
	  $mvFreeLook = false;
}

function Toggle1stPPOV(%val)
//----------------------------------------------------------------------------
// switch between 1st and 3rd person point-of-views.
//----------------------------------------------------------------------------
{
   if (%val)
   {
	  $firstPerson = !$firstPerson;
   }
}

function GoClone(%val)
//----------------------------------------------------------------------------
// clone running forward
//----------------------------------------------------------------------------
{
	for(%i = 10; %i > 0; %i--)
	{
		//$clones.getValue(%i).setVelocity("0 0 10");
		$clones[%i].setVelocity( "0 0 10" );
	}
}

function doTransform()
{
	for(%i = 10; %i > 0; %i--)
	{
		//%xfrm = $clones.getValue(%i).getTransform();
		%xfrm = $clones[%i].getTransform();
		%PosX = getword(%xfrm, 0); //get the current transform values
		//echo("x =" SPC getword(%xfrm, 0) SPC "expected" SPC %PosX);
		%PosY = getword(%xfrm, 1);
		//echo("y =" SPC getword(%xfrm, 1) SPC "expected" SPC %PosY);
		%PosZ = getword(%xfrm, 2);
		//echo("z =" SPC getword(%xfrm, 2) SPC "expected" SPC %PosZ);
		//$clones.getValue(%i).setTransform(%PosX SPC (%PosY + 5) SPC (%PosZ + 5) SPC "0 0 0 0");
		$clones[%i].setTransform(%PosX SPC (%PosY + 5) SPC (%PosZ + 5) SPC "0 0 0 0");
		//echo($clones[0].dump());
	}
}

function doVelocity(%val)
{
	for(%i = 10; %i > 0; %i--)
	{
		//%Vpos = $clones.getValue(%i).getVelocity();
		%Vpos = $clones[%i].getVelocity();
		//$clones.getValue(%i).setVelocity("0" SPC (%Vpos + 20) SPC "0");
		$clones[%i].setVelocity("0" SPC (%Vpos + 20) SPC "0");
		//echo($clones[0].dump());
	}
}

function doScale(%val)
{
	
	for(%i = 10; %i > 0; %i--)
	{
		%Size = $clones[%i].getScale();
		echo("The scale is " SPC %Size);
		$clones[%i].setScale(".5 .5 .5");
	}
}

//============================================================================
// keyboard control mappings
//============================================================================
// these ones available when player is in game
PlayerKeymap.Bind( mouse, button0, MouseAction ); // left mouse button
PlayerKeymap.Bind(keyboard, w, GoAhead);
PlayerKeymap.Bind(keyboard, s, BackUp);
PlayerKeymap.Bind(keyboard, a, GoLeft);
PlayerKeymap.Bind(keyboard, d, GoRight);
PlayerKeymap.Bind(keyboard, space, DoJump );
PlayerKeymap.Bind(keyboard, z, Toggle3rdPPOVLook );
PlayerKeymap.Bind(keyboard, tab, Toggle1stPPOV );

PlayerKeymap.Bind(keyboard, c, GoClone);
PlayerKeymap.Bind(keyboard, b, doTransform);
PlayerKeymap.Bind(keyboard, v, doVelocity);
PlayerKeymap.Bind(keyboard, n, doScale);

PlayerKeymap.Bind(mouse, xaxis, DoYaw );
PlayerKeymap.Bind(mouse, yaxis, DoPitch );

// these ones are always available
GlobalActionMap.BindCmd(keyboard, escape, "", "quit();");
GlobalActionMap.Bind(keyboard, tilde, ToggleConsole);

                    </pre>
			  </div>
			</div>
			<h4>Output: <a rel="shadowbox;width=600;height=500" href="doc/content/Videos/Torque_Clones.flv" title="Random Search">See Video</a></h4>
			</p>
			<p>
			<div class="panelcollapsed">
			  <h3>Torque Front End/UI &amp; Gameplay</h3>
			  <div class="panelcontent">
				<pre class="brush: cpp;" style="overflow: hidden;">
//======================================================================
// 
//
//	See code for Description 
//
// 3D2E emaga4 tutorial game
//
//  Copyright (c) 2003, 2006 by Kenneth C. Finney.
//======================================================================
function startGame()
{
	$Game::Duration = 10*100;
	Timebox.SetValue($Game::Duration);
   if ($Game::Duration) // Start the game timer 
   {
	  $Game::Schedule = schedule( $Game::Duration * 1000, 0, "onGameDurationEnd" );
	  $myRemainingTime = $Game::Duration;
	  schedule(1000, 0, "onEverySecond");
   }
   $Game::Running = true;
   schedule( 2000, 0, "CreateBots");
}

function OnServerCreated()
//----------------------------------------------------------------------------
// Once the engine has fired up the server, this function is called
//----------------------------------------------------------------------------
{
   $Game::StartTime = 0;

   Exec("./misc/sndprofiles.cs");
   Exec("./misc/camera.cs");
   Exec("./misc/shapeBase.cs");
   Exec("./misc/item.cs");
   Exec("./players/player.cs"); // Load the player datablocks and methods
   Exec("./players/beast.cs"); // Load the player datablocks and methods
   Exec("./players/ai.cs"); // Load the player datablocks and methods
   Exec("./weapons/weapon.cs");
   Exec("./weapons/crossbow.cs");
}

//============================================================================
// GameConnection Methods
// Extensions to the GameConnection class. Here we add some methods
// to handle player spawning and creation.
//============================================================================
new AudioDescription( AudioTest ) 
{
   volume       = 1.0;   //default volume
   isLooping    = false;  //loop over and over
   is3D         = true;  //positional?
   type         = 0;     //channel/audio type
};

new AudioProfile ( MoreLoonSound )
{
   filename    = "control/data/sound/hardy2sh.wav";
   description = "AudioTest";
   preload     = true;
};

function BirsSound(%volume)
{
	 %x = GetRandom(-5, 15); //generating random number
	 %y = GetRandom(-5, 15); //generating random number
	 %z = checkSpot(%x, %y);
	if (%z == "")
	{
		schedule( 70, 0, "BirsSound", %volume );
	}
	else 
	{
		%z += 15; 
		alxListenerf( AL_GAIN_LINEAR, %volume );
		$pref::Audio::masterVolume = %volume;
		$Bird = alxPlay(MoreLoonSound, %x SPC %y SPC %z );
		schedule( 1000*5 , 0, "BirsSound", %volume );
	}
	  
}

function checkSpot(%x, %y)
{
   %start    = %x SPC %y SPC "5000";
   %end      = %x SPC %y SPC "-1";
   %ground   = containerRayCast( %start, %end, $TypeMasks::TerrainObjectType, 0 );
   %z        = getWord( %ground, 3 );
   %mask     = $TypeMasks::ForceFieldObjectType
			  | $TypeMasks::InteriorObjectType
			  | $TypeMasks::ItemObjectType
			  | $TypeMasks::MoveableObjectType
			  | $TypeMasks::PlayerObjectType
			  | $TypeMasks::StaticShapeObjectType
			  | $TypeMasks::TerrainObjectType
			  | $TypeMasks::VehicleObjectType;
   %g2       = containerRayCast( %start, %end, %mask, 0 );
   %z2       = getWord( %g2, 3 );
   
   return %z2;
}

function onEverySecond ()
{
  if($myRemainingTime > 0)
   {
	$myRemainingTime--;
	//echo("here" @ $myRemainingTime);
	Timebox.SetValue($myRemainingTime);
	schedule(1000, 0, "onEverySecond");
   }
  else
   {
	schedule( 70, 0, "startGame" );
   }
}
function onGameDurationEnd()
{
	MessageBoxYesNo( "Out of time", "You outta time, sucka! Exit from this Mission?", "Quit();", "Scorebox.SetValue(Scorebox.GetValue()-5);");
}
function GameConnection::SpawnPlayer(%this)
//----------------------------------------------------------------------------
// This is where we place the player spawn decision code.
// It might also call a function that would figure out the spawn
// point transforms by looking up spawn markers.
// Once we know where the player will spawn, then we create the avatar.
//----------------------------------------------------------------------------
{
   $player= %this.createPlayer("0 0 201 1 0 0 0");
   //echo(%this.player);
   //echo(%this.player.getTransform());
}

function GameConnection::CreatePlayer(%this, %spawnPoint)
//----------------------------------------------------------------------------
// Create the player's avatar object, set it up, and give the player control
// of it.
//----------------------------------------------------------------------------
{
   if (%this.player > 0)//The player should NOT already have an avatar object.
   {                     // if he does, that's a Bad Thing.
	  Error( "Attempting to create an angus ghost!" );
   }
   // Create the player object
   %player = new Player() {
	  dataBlock = MaleAvatar;   // defined in players/player.cs
	  client = %this;           // the avatar will have a pointer to its
   };                           // owner's connection

   // Player setup...
   %player.setTransform(%spawnPoint); // where to put it
   $playerid = %player;
   // Update the camera to start with the player
   %this.camera.setTransform(%player.getEyeTransform());
   %player.setEnergyLevel(100);

   // Give the client control of the player
   %this.player = %player;
   echo("this is the player handle" SPC %this.player);
   %this.setControlObject(%player);
}
                    </pre>
			  </div>
			</div>
			<h4>Output: <a rel="shadowbox;width=600;height=500" href="doc/content/Videos/Torque_GameMechanic.flv" title="Random Search">See Video</a></h4>
			</p>
        </div>        
		</div>
      <div class="sidebar">
        <div class="clr"></div>
        <div class="gadget">
          <h2 class="star"><span>Sidebar</span> Menu</h2>
          <div class="clr"></div>
          <ul class="sb_menu">
            <li><a href="myResume.html">Resume</a></li>
            <li><a href="gameSamples.html">Game Samples</a></li>
            <li><a href="codeSamples.html">Code Samples</a></li>
            <li><a href="digitalSamples.html">Digital Samples</a></li>
            <li><a href="myHobbies.html">Hobbies</a></li> 
			<li><a href="myTech.html">Resources</a></li>
            <li><a href="myWebsites.html">Favorite Websites</a></li>
          </ul>
        </div>
      </div>
      <div class="clr"></div>
    </div>
  </div>
  <div class="fbg">
    <div class="fbg_resize">
       <div class="col c1">
        <h2><span></span> 	</h2>
        <p></p>    
	  </div>      
      <div class="col c2">
        <h2><span>Contact</span> Me</h2>
        <p>For information regarding my portfolio or even if you just want to say hello.</p>
        <p class="contact_info"> <span>Telephone:</span> +See Resume<br />
		  <span>E-mail:</span><a href="mailto:Hardik.R.Bhatt@gmail.com">Hardik.R.Bhatt@gmail.com</a></p>
      </div>
	  <div class="col c3">
        <h2><span></span> 	</h2>
        <p></p>        
      </div>
      <div class="clr"></div>
    </div>
  </div>
   <div class="footer">
    <div class="footer_resize">
      <p class="lf">&copy; Copyright <a href="http://www.hardibhatt.com/">http://www.hardibhatt.com/</a> 2011.</p>
      <div style="clear:both;"></div>
    </div>
  </div>
</div>
</body>
</html>
