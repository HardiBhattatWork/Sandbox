<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>Hardi Bhatt's Vimeo Simple API</title>
		<link href="css/bootstrap.min.css" rel="stylesheet" type="text/css">
		<script src="js/jquery-2.0.3.min.js" type="text/javascript"></script>
	    <script src="js/bootstrap.min.js"></script>
	    <script src="js/jquery.twbsPagination.js" type="text/javascript"></script>
	    <style>
			#page-content iframe {
				width: 90%;
			}
		</style>
		<script type="text/javascript">
			
			var vimeoJson = null;
			var apiEndpoint = "http://vimeo.com/api/v2/channel/staffpicks/videos.json";
			var oEmbedUrl = 'http://vimeo.com/api/oembed.json';
			var oEmbedCallback = 'embedVideo';

			// Call our init function when the page loads
			/*window.onload = function() {
			    loadScript(videosUrl);
			};*/
			$(document).ready(function () {
				
				$.getJSON( apiEndpoint, vimeoCallBack);
				function vimeoCallBack(data)
				{
					vimeoJson = data;
					paginationVimeo(vimeoJson);
					getVimeoURL(vimeoJson, 0); 
				}
			});
			
			function paginationVimeo(vimeoJson){
				
				//retrieve JSON object check length and populate below.
				 $('#pagination').twbsPagination({
				    totalPages: vimeoJson.length,
				    visiblePages: 7,
				    onPageClick: function (event, page) {
				        getVimeoURL(vimeoJson, page-1); 
				    }
				});
			}
			// This function puts the video on the page
			function embedVideo(video) {
				videoEmbedCode = video.html;
				document.getElementById('page-content').innerHTML = unescape(video.html);
			}

			function getVimeoURL(vimeoJson, page) {
				//Memoizing previously computed URL
				if (!getVimeoURL.url) getVimeoURL.url = {};
				
				if (getVimeoURL.url[page] != null) {
					return getVimeoURL.url[page];
			 	} 
			 	var getURL = oEmbedUrl + '?url=' + encodeURIComponent(vimeoJson[page].url) + '&callback=' + oEmbedCallback
			 	loadScript(getURL);

				// This function loads the data from Vimeo
				function loadScript(url) {
					
					var js = document.createElement('script');
					js.setAttribute('type', 'text/javascript');

					js.setAttribute('src', url);
					document.getElementsByTagName('head').item(0).appendChild(js);
				}
				return $('#page-content').text("An Error has occured");
			}
		</script>
	</head>
	<body>
		<div class="inner ">
        	<h1>Vimeo Simple API</h1>
        	<div class="text-center">
        		<div id="images"></div>
	        	<div id="page-content" class="well">Page 1</div>
	        	<ul id="pagination" class="pagination-sm text-center"></ul>
        	</div>
    	</div>
	</body>
</html>